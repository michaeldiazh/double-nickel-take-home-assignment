[
  {
    "testName": "building basic select query for conversation",
    "input": {
      "selectColumns": ["id", "is_active", "screening_decision"],
      "fromTable": "conversation"
    },
    "expected": {
      "query": "select id, is_active, screening_decision\n    from conversation",
      "values": []
    }
  },
  {
    "testName": "building select query for conversation with WHERE clause",
    "input": {
      "selectColumns": ["id", "is_active", "screening_decision"],
      "fromTable": "conversation",
      "whereClause": [
        {
          "tableName": "conversation",
          "column": "is_active",
          "filter": "=",
          "value": true
        }
      ]
    },
    "expected": {
      "query": "select id, is_active, screening_decision\n    from conversation\n    \n    where conversation.is_active = $1",
      "values": [true]
    }
  },
  {
    "testName": "building select query for conversation with JOIN to application",
    "input": {
      "selectColumns": ["conversation.id", "conversation.screening_decision", "application.status"],
      "fromTable": "conversation",
      "joinClauses": [
        {
          "joinOperator": "join",
          "sourceTable": "conversation",
          "targetTable": "application",
          "relationship": [["app_id", "id"]]
        }
      ]
    },
    "expected": {
      "query": "select conversation.id, conversation.screening_decision, application.status\n    from conversation\n    join application on conversation.app_id = application.id",
      "values": []
    }
  },
  {
    "testName": "building select query for conversation with LEFT JOIN to application",
    "input": {
      "selectColumns": ["conversation.id", "application.status"],
      "fromTable": "conversation",
      "joinClauses": [
        {
          "joinOperator": "left join",
          "sourceTable": "conversation",
          "targetTable": "application",
          "relationship": [["app_id", "id"]]
        }
      ]
    },
    "expected": {
      "query": "select conversation.id, application.status\n    from conversation\n    left join application on conversation.app_id = application.id",
      "values": []
    }
  },
  {
    "testName": "building select query for conversation with WHERE and JOIN",
    "input": {
      "selectColumns": ["conversation.id", "conversation.screening_decision", "application.status"],
      "fromTable": "conversation",
      "joinClauses": [
        {
          "joinOperator": "join",
          "sourceTable": "conversation",
          "targetTable": "application",
          "relationship": [["app_id", "id"]]
        }
      ],
      "whereClause": [
        {
          "tableName": "conversation",
          "column": "is_active",
          "filter": "=",
          "value": true
        },
        {
          "tableName": "application",
          "column": "status",
          "filter": "=",
          "value": "IN_PROGRESS"
        }
      ]
    },
    "expected": {
      "query": "select conversation.id, conversation.screening_decision, application.status\n    from conversation\n    join application on conversation.app_id = application.id\n    where conversation.is_active = $1 and application.status = $2",
      "values": [true, "IN_PROGRESS"]
    }
  },
  {
    "testName": "building select query for conversation with WHERE, JOIN and ORDER BY",
    "input": {
      "selectColumns": ["conversation.id", "conversation.created_at", "application.applied_on"],
      "fromTable": "conversation",
      "joinClauses": [
        {
          "joinOperator": "join",
          "sourceTable": "conversation",
          "targetTable": "application",
          "relationship": [["app_id", "id"]]
        }
      ],
      "whereClause": [
        {
          "tableName": "conversation",
          "column": "screening_decision",
          "filter": "=",
          "value": "PENDING"
        }
      ],
      "orderBy": [
        {
          "tableName": "conversation",
          "column": "created_at",
          "orderOption": "desc"
        }
      ]
    },
    "expected": {
      "query": "select conversation.id, conversation.created_at, application.applied_on\n    from conversation\n    join application on conversation.app_id = application.id\n    where conversation.screening_decision = $1\n    \n    order by conversation.created_at desc",
      "values": ["PENDING"]
    }
  }
]

